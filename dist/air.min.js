function Rlite(){this.rules={}}Rlite.prototype={add:function(t,e){for(var r,i,n=t.split("/"),o=this.rules,a=0;a<n.length;++a)r=n[a],i=r.length&&":"==r.charAt(0)?":":r,o[i]?o=o[i]:(o=o[i]={},":"==i&&(o["@name"]=r.substr(1,r.length-1)));o["@"]=e},run:function(t){t&&t.length&&(t=t.replace("/?","?"),"/"==t.charAt(0)&&(t=t.substr(1,t.length)),t.length&&"/"==t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)));var e=this.rules,r=t.split("?",2),i=r[0].split("/",50),n={};return function(){for(var t=0;t<i.length&&e;++t){var r=i[t],o=r.toLowerCase(),a=e[o];!a&&(a=e[":"])&&(n[a["@name"]]=r),e=a}}(),function(t){for(var e,r=t.split("&",50),i=0;i<r.length;++i)e=r[i].split("=",2),2==e.length&&(n[e[0]]=e[1])}(2==r.length?r[1]:""),e&&e["@"]?(e["@"]({url:t,params:n}),!0):!1}},air={$:function(t){return new air.Dom(t)},apps:{},app:function(t,e){var r=this.apps[t];return r||(r=new air.App(t,e),this.apps[t]=r),r}},air.Dom=function(t){this.element=document.querySelector(t)},air.Dom.prototype.html=function(t){return t?(this.element.innerHTML=t,this):this.element.innerHTML},air.App=function(t,e){this.name=t,this.options=e||{},this.routes=this.options.routes||[],this.controllers=this.options.controllers||{},this.views=this.options.views||{}},air.App.prototype.controller=function(t,e){var r,i;r=new air.Controller(t,e),this.controllers[t]=r;for(i in e)e.hasOwnProperty(i)&&this.routes.push("default"===i.toLowerCase()?t:t+"/"+i);return r},air.App.prototype.view=function(t,e){this.views[t]=new air.View(t,e)},air.App.prototype.init=function(){this.router=new air.Router(this.name,this.routes),this.router.init()},air.Router=function(t,e){var r,i,n,o=this,a=function(t){o.execRouteLogic(t)};for(this.appName=t,this.r||(this.rlite=new Rlite),r=0,i=e.length;i>r;r++)n=e[r],this.rlite.add(n,a)},air.Router.prototype.getControllerName=function(t){return t.split("/")[0]},air.Router.prototype.getControllerMethod=function(t){var e=t.split("/");return e[1]?e[1].split("?")[0]:"default"},air.Router.prototype.execRouteLogic=function(t){var e=this.getControllerName(t.url),r=this.getControllerMethod(t.url),i=air.apps[this.appName].controllers[e];i.invokeMethod(r,t.params)},air.Router.prototype.init=function(){var t=this,e=function(){var e=location.hash||"#";t.rlite.run(e.substr(1))};window.addEventListener("hashchange",e),e()},air.Controller=function(t,e){this.name=t,this.methods=e||{}},air.Controller.prototype.invokeMethod=function(t,e){var r,i,n=this.methods[t];n?(r=n.apply(this,e),typeof r===air.View&&r.render()):(i=this.name+"/"+t,new air.View(i,{templateData:e}).render())},air.Template=function(t,e){this.name=t,this.domId=e||'script[data-air="'+t+'"]',this.raw=air.$(this.domId).element.innerHTML.trim()},air.Template.prototype.compile=function(t){var e,r=this.raw;for(e in t)r=r.replace(new RegExp("{{"+e+"}}","g"),t[e]);return r},air.View=function(t,e){e=e||{},this.name=t,this.el=e.el||':not(script)[data-air="'+t+'"]',this.templateData=e.templateData||{},this.template=new air.Template(t)},air.View.prototype.render=function(){var t=air.$(this.el),e=this.template.compile(this.templateData);t.html(e)};