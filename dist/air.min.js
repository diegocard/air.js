function Rlite(){this.rules={}}air={$:function(t){return new air.Dom(t)},apps:{},app:function(t,i){var e=this.apps[t];return e||(e=new air.App(t,i),this.apps[t]=e),e},navigate:function(t){t=t||"",window.location.href=t},run:function(t){var i;for(i in air.apps)air.apps[i].router.run(t)},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isObject:function(t){return t===Object(t)&&!air.isFunction(t)},isStrictlyObject:function(t){return air.isObject(t)&&!air.isArray(t)},isBoolean:function(t){return t===!0||t===!1},isString:function(t){return"[object String]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},isUndefined:function(t){return"undefined"==typeof t},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},air.settings={DEFAULT_CONTROLLER_NAME:"default",DEFAULT_CONTROLLER_METHOD:"default"},air.Dom=function(t){this.element=document.querySelector(t)},air.Dom.prototype.html=function(t){return t?(this.element.innerHTML=t,this):this.element.innerHTML},air.App=function(t,i){this.name=t,this.options=i||{},this.routes=this.options.routes||[],this.controllers=this.options.controllers||{},this.views=this.options.views||{}},air.App.prototype.controller=function(t,i){var e,r;e=new air.Controller(t,i),this.controllers[t]=e;for(r in i)i.hasOwnProperty(r)&&this.routes.push(r.toLowerCase()===air.settings.DEFAULT_CONTROLLER_METHOD?t:t+"/"+r);return e},air.App.prototype.view=function(t,i){this.views[t]=new air.View(t,i)},air.App.prototype.init=function(){this.router=new air.Router(this.name,this.routes),this.router.init()},air.Router=function(t,i){var e,r,n,o=this,a=function(t){var i=t.url.split("/"),e=i[0]||air.settings.DEFAULT_CONTROLLER_NAME,r=i[1]?i[1].split("?")[0]:air.settings.DEFAULT_CONTROLLER_METHOD,n=air.apps[o.appName].controllers[e];n.invokeMethod(r,t.params)};for(this.appName=t,this.r||(this.rlite=new Rlite),i.indexOf(air.settings.DEFAULT_CONTROLLER_NAME)>-1&&i.push(""),e=0,r=i.length;r>e;e++)n=i[e],this.rlite.add(n,a)},air.Router.prototype.run=function(t){this.rlite.run(t)},air.Router.prototype.init=function(){var t=this,i=function(){var i=location.hash||"#";t.rlite.run(i.substr(1))};window.addEventListener("hashchange",i),i()},air.Model=function(t,i){i=i||{},this.name=t,this.data=i},air.Controller=function(t,i){this.name=t,this.methods=i||{}},air.Controller.prototype.invokeMethod=function(t,i){var e,r,n=this.methods[t];n?(e=n.apply(this,i),typeof e===air.View&&e.render()):(r=this.name,t&&t!=air.settings.DEFAULT_CONTROLLER_METHOD&&(r+="/"+t),new air.View(r,{templateData:i}).render())},air.Template=function(t,i){this.name=t,air.isFunction(i)?this.compile=i:this.templateId=i||'script[data-air="'+t+'"]'},air.Template.prototype.cache=[],air.Template.prototype.compile=function(t){var i=this.cache[this.name]||air.$(this.templateId).element.innerHTML,e=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+i.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return e(t.data)},air.View=function(t,i){i=i||{},this.name=t,this.el=i.el||':not(script)[data-air="'+t+'"]',this.model=i.model||new air.Model(t),this.template=new air.Template(t,i.template)},air.View.prototype.render=function(){var t=air.$(this.el),i=this.template.compile(this.model);t.html(i)},Rlite.prototype={add:function(t,i){for(var e,r,n=t.split("/"),o=this.rules,a=0;a<n.length;++a)e=n[a],r=e.length&&":"==e.charAt(0)?":":e,o[r]?o=o[r]:(o=o[r]={},":"==r&&(o["@name"]=e.substr(1,e.length-1)));o["@"]=i},run:function(t){t&&t.length&&(t=t.replace("/?","?"),"/"==t.charAt(0)&&(t=t.substr(1,t.length)),t.length&&"/"==t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)));var i=this.rules,e=t.split("?",2),r=e[0].split("/",50),n={};return function(){for(var t=0;t<r.length&&i;++t){var e=r[t],o=e.toLowerCase(),a=i[o];!a&&(a=i[":"])&&(n[a["@name"]]=e),i=a}}(),function(t){for(var i,e=t.split("&",50),r=0;r<e.length;++r)i=e[r].split("=",2),2==i.length&&(n[i[0]]=i[1])}(2==e.length?e[1]:""),i&&i["@"]?(i["@"]({url:t,params:n}),!0):!1}};