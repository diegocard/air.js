air={$:function(t){return new air.Dom(t)},apps:{},app:function(t,e){var n=this.apps[t];return n||(n=new air.App(t,e),this.apps[t]=n),n},navigate:function(t){t=t||"",window.location.href=t},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isObject:function(t){return t===Object(t)&&!air.isFunction(t)},isStrictlyObject:function(t){return air.isObject(t)&&!air.isArray(t)},isBoolean:function(t){return t===!0||t===!1},isString:function(t){return"[object String]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},isUndefined:function(t){return"undefined"==typeof t},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},air.settings={DEFAULT_CONTROLLER_NAME:"default",DEFAULT_CONTROLLER_METHOD:"default"},air.Dom=function(t){this.element=document.querySelector(t)},air.Dom.prototype.html=function(t){return t?(this.element.innerHTML=t,this):this.element.innerHTML},air.App=function(t,e){this.name=t,this.options=e||{},this.routes=this.options.routes||[],this.controllers=this.options.controllers||{},this.views=this.options.views||{}},air.App.prototype.controller=function(t,e){var n,i;n=new air.Controller(t,e),this.controllers[t]=n;for(i in e)e.hasOwnProperty(i)&&this.routes.push(i.toLowerCase()===air.settings.DEFAULT_CONTROLLER_METHOD?t:t+"/"+i);return n},air.App.prototype.view=function(t,e){this.views[t]=new air.View(t,e)},air.App.prototype.init=function(){this.router=new air.Router(this.name,this.routes)},air.Router=function(t,e){var n,i,r,o=this,a=function(t){return o.navigate(t)};for(this.appName=t,e.indexOf(air.settings.DEFAULT_CONTROLLER_NAME)>-1&&e.push(""),n=0,i=e.length;i>n;n++)r=e[n],routie(r,a)},air.Router.prototype.getControllerName=function(t){return t.split("/")[0]||air.settings.DEFAULT_CONTROLLER_NAME},air.Router.prototype.getControllerMethod=function(t){var e=t.split("/");return e[1]?e[1].split("?")[0]:air.settings.DEFAULT_CONTROLLER_METHOD},air.Router.prototype.navigate=function(t){var e=this.getControllerName(t.url),n=this.getControllerMethod(t.url),i=air.apps[this.appName].controllers[e];i.invokeMethod(n,t.params)},air.Controller=function(t,e){this.name=t,this.methods=e||{}},air.Controller.prototype.invokeMethod=function(t,e){var n,i,r=this.methods[t];r?(n=r.apply(this,e),typeof n===air.View&&n.render()):(i=this.name,t&&t!=air.settings.DEFAULT_CONTROLLER_METHOD&&(i+="/"+t),new air.View(i,{templateData:e}).render())},air.Template=function(t,e){this.name=t,air.isFunction(e)?this.compile=e:(this.domId=e||'script[data-air="'+t+'"]',this.element=air.$(this.domId).element)},air.Template.prototype.cache=[],air.Template.prototype.compile=function t(e){e=e||{};var n=this.elment.innerHTML.trim(),i=air.Template.prototype.cache,r=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[this.name]=i[this.name]||t(document.getElementById(n).innerHTML);return e?r(e):r},air.View=function(t,e){e=e||{},this.name=t,this.el=e.el||':not(script)[data-air="'+t+'"]',this.model=e.model||new air.Model(t),this.template=new air.Template(t)},air.View.prototype.render=function(){var t=air.$(this.el),e=this.template.compile(this.model);t.html(e)},function(t){var e=[],n={},i="routie",r=t[i],o=function(t,e){this.name=e,this.path=t,this.keys=[],this.fns=[],this.params={},this.regex=a(this.path,this.keys,!1,!1)};o.prototype.addHandler=function(t){this.fns.push(t)},o.prototype.removeHandler=function(t){for(var e=0,n=this.fns.length;n>e;e++){var i=this.fns[e];if(t==i)return void this.fns.splice(e,1)}},o.prototype.run=function(t){for(var e=0,n=this.fns.length;n>e;e++)this.fns[e].apply(this,t)},o.prototype.match=function(t,e){var n=this.regex.exec(t);if(!n)return!1;for(var i=1,r=n.length;r>i;++i){var o=this.keys[i-1],a="string"==typeof n[i]?decodeURIComponent(n[i]):n[i];o&&(this.params[o.name]=a),e.push(a)}return!0},o.prototype.toURL=function(t){var e=this.path;for(var n in t)e=e.replace("/:"+n,"/"+t[n]);if(e=e.replace(/\/:.*\?/g,"/").replace(/\?/g,""),-1!=e.indexOf(":"))throw Error("missing parameters for url: "+e);return e};var a=function(t,e,n,i){return t instanceof RegExp?t:(t instanceof Array&&(t="("+t.join("|")+")"),t=t.concat(i?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(t,n,i,r,o,a){return e.push({name:r,optional:!!a}),n=n||"",""+(a?"":n)+"(?:"+(a?n:"")+(i||"")+(o||i&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),RegExp("^"+t+"$",n?"":"i"))},s=function(t,i){var r=t.split(" "),a=2==r.length?r[0]:null;t=2==r.length?r[1]:r[0],n[t]||(n[t]=new o(t,a),e.push(n[t])),n[t].addHandler(i)},p=function(t,e){if("function"==typeof e)s(t,e),p.reload();else if("object"==typeof t){for(var n in t)s(n,t[n]);p.reload()}else void 0===e&&p.navigate(t)};p.lookup=function(t,n){for(var i=0,r=e.length;r>i;i++){var o=e[i];if(o.name==t)return o.toURL(n)}},p.remove=function(t,e){var i=n[t];i&&i.removeHandler(e)},p.removeAll=function(){n={},e=[]},p.navigate=function(t,e){e=e||{};var n=e.silent||!1;n&&f(),setTimeout(function(){window.location.hash=t,n&&setTimeout(function(){h()},1)},1)},p.noConflict=function(){return t[i]=r,p};var u=function(){return window.location.hash.substring(1)},c=function(t,e){var n=[];return e.match(t,n)?(e.run(n),!0):!1},l=p.reload=function(){for(var t=u(),n=0,i=e.length;i>n;n++){var r=e[n];if(c(t,r))return}},h=function(){t.addEventListener?t.addEventListener("hashchange",l,!1):t.attachEvent("onhashchange",l)},f=function(){t.removeEventListener?t.removeEventListener("hashchange",l):t.detachEvent("onhashchange",l)};h(),t[i]=p}(window);