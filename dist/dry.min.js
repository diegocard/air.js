dry={$:function(t){return new dry.Dom(t)},apps:{},app:function(t,e){return this.apps[t]||(this.apps[t]=new dry.App(t,e))},navigate:function(t){window.location.href=t||""},run:function(t){var e;for(e in dry.apps)dry.apps[e].router.run(t)}},dry.settings={DEFAULT_CONTROLLER_NAME:"default",DEFAULT_CONTROLLER_METHOD:"default"},dry.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},dry.isObject=function(t){return t===Object(t)&&!dry.isFunction(t)},dry.isStrictlyObject=function(t){return dry.isObject(t)&&!dry.isArray(t)},dry.isBoolean=function(t){return t===!0||t===!1},dry.isString=function(t){return"[object String]"===Object.prototype.toString.call(t)},dry.isFunction=function(t){return"[object Function]"===Object.prototype.toString.call(t)},dry.isUndefined=function(t){return"undefined"==typeof t},dry.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},dry.keys=function(t){var e,r=[];for(e in t)t.hasOwnProperty(e)&&r.push(e);return r},dry.each=function(t,e,r){var n,i,o;if(dry.isStrictlyObject(t))for(o=dry.keys(t),n=0,i=o.length;i>n;n++)e.call(r,t[o[n]],o[n],t);else for(n=0,i=t.length;i>n;n++)e.call(r,t[n],n,t)},dry.ajax=function(t){var e,r=t.type||"GET",n=r.toUpperCase()||"GET",i=new XMLHttpRequest;return i.open(n,t.url,!0),i.onreadystatechange=function(){if(4===this.readyState)if(this.status>=200&&this.status<400&&t.success)try{e=JSON.parse(this.responseText),t.success(e)}catch(r){t.success(this.responseText)}else t.error&&t.error(this)},i.timeout=t.timeout||1e4,i.ontimeout=t.ontimeout||function(){console.error("dry.ajax timeout for url",t.url)},"GET"===n?i.send():n&&(i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.send(dry.param(t.data))),i=null,this},dry.getJSON=function(t,e,r){return dry.ajax({type:"GET",url:t,success:function(t){e&&e(JSON.parse(t))},error:r})},dry.get=function(t,e,r){return dry.ajax({type:"GET",url:t,success:e,error:r})},dry.each(["post","put","delete"],function(t){dry[t]=function(e,r,n,i){return dry.ajax({type:t,url:e,data:r,success:n,error:i})}}),dry.jsonp=function(t,e){var r="dry_jsonp_callback_"+Math.round(1e5*Math.random());window[r]=function(t){delete window[r],document.body.removeChild(n),e(t)};var n=document.createElement("script");n.src=t+(t.indexOf("?")>=0?"&":"?")+"callback="+r,document.body.appendChild(n)},dry.param=function(t){var e,r=/%20/g,n=/\[\]$/,i=[],o=function(t,e){e=dry.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)},s=function(t,e,r){var i;if(dry.isArray(e))dry.each(e,function(e,i){n.test(t)?r(t,e):s(t+"["+("object"==typeof e?i:"")+"]",e,r)});else if(dry.isObject(e))for(i in e)s(t+"["+i+"]",e[i],r);else r(t,e)};if(dry.isArray(t)||!dry.isStrictlyObject(t))dry.each(t,function(){o(this.name,this.value)});else for(e in t)s(e,t[e],o);return i.join("&").replace(r,"+")},dry.Dom=function(t){this.element=document.querySelector(t)},dry.Dom.prototype.html=function(t){return t?(this.element.innerHTML=t,this):this.element.innerHTML},dry.Dom.prototype.on=function(t,e){this.element.addEventListener(t,e)},dry.Dom.prototype.off=function(t,e){this.element.removeEventListener(t,e)},dry.Dom.prototype.trigger=function(t,e){var r;window.CustomEvent?r=new CustomEvent(t,{detail:e}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!0,!0,e)),this.element.dispatchEvent(r)},dry.App=function(t,e){this.name=t,this.options=e||{},this.routes=this.options.routes||[],this.filters=this.options.filters||{},this.controllers=this.options.controllers||{},this.views=this.options.views||{},this.modelDefinitions=this.options.models||{}},dry.App.prototype.controller=function(t,e){var r,n=this;return dry.isUndefined(e)?r=this.controllers[t]:(r=new dry.Controller(t,e),this.controllers[t]=r,dry.each(e,function(e,r){r.toLowerCase()===dry.settings.DEFAULT_CONTROLLER_METHOD?n.routes.push(t):n.routes.push(t+"/"+r)})),r},dry.App.prototype.redirect=function(t,e,r){this.controllers[t].invokeMethod(e,r)},dry.App.prototype.view=function(t,e){return dry.isUndefined(e)?this.views[t]:(this.views[t]=new dry.View(t,e),void 0)},dry.App.prototype.init=function(){this.router=new dry.Router(this.name,this.routes),this.router.init()},dry.App.prototype.model=function(t,e){return e?(this.modelDefinitions[t]=e,void 0):new dry.Model(t,this.modelDefinitions[t])},dry.Router=function(t,e){this.rules={};var r,n,i,o=this,s=function(t){var e=t.url.split("/"),r=e[0]||dry.settings.DEFAULT_CONTROLLER_NAME,n=e[1]?e[1].split("?")[0]:dry.settings.DEFAULT_CONTROLLER_METHOD,i=dry.apps[o.appName].controllers[r];i.invokeMethod(n,t.params)};for(this.appName=t,e.indexOf(dry.settings.DEFAULT_CONTROLLER_NAME)>-1&&e.push(""),r=0,n=e.length;n>r;r++)i=e[r],this.add(i,s)},dry.Router.prototype.add=function(t,e){for(var r=t.split("/"),n=this.rules,i=0;i<r.length;++i){var o=r[i],s=o.length&&":"==o.charAt(0)?":":o;n[s]?n=n[s]:(n=n[s]={},":"==s&&(n["@name"]=o.slice(1)))}n["@"]=e},dry.Router.prototype.run=function(t){t&&t.length&&(t=t.replace("/?","?"),"/"==t.charAt(0)&&(t=t.slice(1)),t.length&&"/"==t.slice(-1)&&(t=t.slice(0,-1)));var e=this.rules,r=t.split("?",2),n=r[0].split("/",50),i={};return function(){for(var t=0;t<n.length&&e;++t){var r=n[t],o=e[r.toLowerCase()];!o&&(o=e[":"])&&(i[o["@name"]]=r),e=o}}(),function(t){for(var e=t.split("&",50),r=0;r<e.length;++r){var n=e[r].split("=",2);2==n.length&&(i[n[0]]=n[1])}}(2==r.length?r[1]:""),e&&e["@"]?(e["@"]({url:t,params:i}),!0):!1},dry.Router.prototype.init=function(){var t=this,e=function(){var e=location.hash||"#";t.run(e.substr(1))};window.addEventListener("hashchange",e),e()},dry.Model=function(t,e){e=e||{},this.name=t,this.attributes=e.attributes||{};var r=this;dry.each(e,function(t,e){var n,i,o;dry.isString(t)&&(n=t.split(" "),i=n[0],o=n[1],r[e]=r.endpointMethod(i,o))})},dry.Model.prototype.endpointMethod=function(t,e){return function(r,n,i){var o,s,d=e,c=this.attributes;for(o in c)d=d.replace("{"+o+"}",c[o]);for(s in r)d=d.replace("{"+s+"}",r[s]);return dry.ajax({url:d,type:t,data:r,success:n,error:i})}},dry.Filter=function(t,e,r){this.name=t,this.condition=e,this.action=r},dry.Filter.prototype.runFilter=function(){var t=this.condition();return t&&this.action&&this.action(),t},dry.Controller=function(t,e){this.name=t,this.methods=e||{}},dry.Controller.prototype.invokeMethod=function(t,e){var r,n,i=this.methods[t];i?r=i.call(this,e):(n=this.name,t&&t!=dry.settings.DEFAULT_CONTROLLER_METHOD&&(n+="/"+t),r=new dry.View(n,{templateData:e,controller:this})),r&&r.constructor===dry.View&&(r.controller=r.controller||this,r.render())},dry.Controller.prototype.redirect=function(t,e){this.invokeMethod(t,e)},dry.Template=function(t,e){this.name=t,dry.isFunction(e)?this.compile=e:this.templateId=e||'script[data-dry="'+t+'"]'},dry.Template.prototype.cache=[],dry.Template.prototype.compile=function(t){var e=this.cache[this.name]||dry.$(this.templateId).element.innerHTML,r=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return r(t.attributes)},dry.View=function(t,e){e=e||{},this.name=t,this.el=e.el||':not(script)[data-dry="'+t+'"]',this.model=e.model||new dry.Model(t),this.template=new dry.Template(t,e.template),this.controller=e.controller,this.events=e.events||{}},dry.View.prototype.render=function(){var t=dry.$(this.el),e=this.template.compile(this.model),r=this.events,n=this;t.html(e),dry.each(r,function(t,e){n.addEvent(e,t)})},dry.View.prototype.addEvent=function(t,e){var r,n,i;r=t.split(" "),n=r[1],i=r[0],dry.isString(e)&&(e=function(t){this.controller.invokeMethod(e,t)}),dry.$(n).on(i,e)};